// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// --- TABELA VIP ---
model Vip {
  userId          String   @id @unique // ID do Discord
  tier            String   @default("default")
  since           DateTime @default(now())
  expiresAt       DateTime?
  customRoleId    String?  // ID da Tag criada
  customChannelId String?  // ID do Canal criado
  
  friends         VipFriend[] // Relação com amigos
}

// Tabela para os amigos convidados pelos VIPs
model VipFriend {
  friendId String @id @unique // ID do amigo
  ownerId  String // ID do dono do VIP que convidou
  
  owner    Vip    @relation(fields: [ownerId], references: [userId], onDelete: Cascade)
}

// --- TABELA PRIMEIRA DAMA (PD) ---
model Pd {
  memberId String   @id @unique
  staffId  String   // Quem indicou
  since    DateTime @default(now())
}

// --- TABELAS DE PROTEÇÃO ---
model Panela {
  userId String @id @unique
}

model Blacklist {
  userId String @id @unique
}

// --- TABELA BOOSTER (NOVO) ---
model Booster {
  userId          String   @id @unique
  since           DateTime @default(now())
  customRoleId    String?  // ID da Tag do Booster
  customChannelId String?  // ID do Canal do Booster
  
  friends         BoosterFriend[]
}

model BoosterFriend {
  friendId String @id @unique
  ownerId  String
  
  owner    Booster @relation(fields: [ownerId], references: [userId], onDelete: Cascade)
}

// --- SISTEMA DE ECONOMIA ---
model Economy {
  id        Int       @id @default(autoincrement())
  userId    String
  guildId   String    // Economia separada por servidor (boa prática)
  wallet    Int       @default(0)
  bank      Int       @default(0)
  lastDaily DateTime? // Data do último daily
  lastWork  DateTime? // Data do último trabalho

  @@unique([userId, guildId])
}

// --- SISTEMA DE ITENS ---
model Inventory {
  id        Int     @id @default(autoincrement())
  userId    String
  guildId   String
  itemId    String  // Ex: "gun", "shield", "lock"
  quantity  Int     @default(1)

  @@unique([userId, guildId, itemId])
}